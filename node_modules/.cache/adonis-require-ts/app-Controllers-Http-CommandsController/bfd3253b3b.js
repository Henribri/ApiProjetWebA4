"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const Command_1 = __importDefault(global[Symbol.for('ioc.use')]("App/Models/Command"));
const jsonwebtoken_1 = __importDefault(require("jsonwebtoken"));
class CommandsController {
    async getCommand({ request, response }) {
        try {
            return await Command_1.default.findOne({ _id: request.input('command_id') });
        }
        catch (err) {
            return response.status(502);
        }
    }
    async createCommand({ request, response }) {
        try {
            await Command_1.default.create(request.body());
            return response.ok("Command created");
        }
        catch (err) {
            return response.status(502);
        }
    }
    async editCommand({ request, response }) {
        try {
            await Command_1.default.updateOne({ _id: request.input('command_id') }, request.body());
            return response.ok("Command edited");
        }
        catch (err) {
            return response.status(502);
        }
    }
    async deleteCommand({ request, response }) {
        try {
            await Command_1.default.deleteOne({ _id: request.input('command_id') });
            return response.ok("Command deleted");
        }
        catch (err) {
            return response.status(502);
        }
    }
    async payCommand({ request, response }) {
        try {
            await Command_1.default.updateOne({ _id: request.input('command_id') }, { paid: true });
            return response.ok("Command paid");
        }
        catch (err) {
            return response.status(502);
        }
    }
    async validateCommand({ request, response }) {
        try {
            await Command_1.default.updateOne({ _id: request.input('command_id') }, { validated: true });
            return response.ok("Command validated");
        }
        catch (err) {
            return response.status(502);
        }
    }
    async getHistoricCommand({ request, response }) {
        try {
            const token = request.header('authorization').split(" ");
            const user_id = jsonwebtoken_1.default.verify(token[1], "TOKEN_PRIVATE_KEY").user_id;
            return response.send(await Command_1.default.find({ 'info.client.user_id': user_id }));
        }
        catch (err) {
            return response.status(502);
        }
    }
    async deleteHistoricCommand({ request, response }) {
        try {
            await Command_1.default.deleteMany({ _id: { $in: request.body().delete_historic } });
            return response.ok("Commands deleted");
        }
        catch (err) {
            return response.status(502);
        }
    }
}
exports.default = CommandsController;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29tbWFuZHNDb250cm9sbGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQ29tbWFuZHNDb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsdUZBQXlDO0FBQ3pDLGdFQUE4QjtBQUc5QixNQUFxQixrQkFBa0I7SUFXNUIsS0FBSyxDQUFDLFVBQVUsQ0FBRSxFQUFDLE9BQU8sRUFBRSxRQUFRLEVBQXFCO1FBQzVELElBQUk7WUFDQSxPQUFPLE1BQU0saUJBQU8sQ0FBQyxPQUFPLENBQUMsRUFBQyxHQUFHLEVBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsRUFBQyxDQUFDLENBQUE7U0FDbEU7UUFBQSxPQUFNLEdBQUcsRUFBQztZQUNQLE9BQU8sUUFBUSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQTtTQUM5QjtJQUNMLENBQUM7SUFVTSxLQUFLLENBQUMsYUFBYSxDQUFFLEVBQUMsT0FBTyxFQUFFLFFBQVEsRUFBcUI7UUFDL0QsSUFBRztZQUNDLE1BQU0saUJBQU8sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUE7WUFDcEMsT0FBTyxRQUFRLENBQUMsRUFBRSxDQUFDLGlCQUFpQixDQUFDLENBQUE7U0FDeEM7UUFBQSxPQUFNLEdBQUcsRUFBQztZQUNQLE9BQU8sUUFBUSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQTtTQUM5QjtJQUVMLENBQUM7SUFXTSxLQUFLLENBQUMsV0FBVyxDQUFFLEVBQUMsT0FBTyxFQUFFLFFBQVEsRUFBcUI7UUFDN0QsSUFBRztZQUNDLE1BQU0saUJBQU8sQ0FBQyxTQUFTLENBQUMsRUFBQyxHQUFHLEVBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsRUFBQyxFQUFFLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFBO1lBQzFFLE9BQU8sUUFBUSxDQUFDLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFBO1NB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bnRyYWN0IH0gZnJvbSAnQGlvYzpBZG9uaXMvQ29yZS9IdHRwQ29udGV4dCdcclxuaW1wb3J0IENvbW1hbmQgZnJvbSBcIkFwcC9Nb2RlbHMvQ29tbWFuZFwiO1xyXG5pbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbidcclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21tYW5kc0NvbnRyb2xsZXIge1xyXG5cclxuXHJcbiAgICAvKiogXHJcbiAgICAgKiBAYXBpIHtnZXR9IC9nZXRfY29tbWFuZCBSZXF1ZXN0IGNvbW1hbmQgaW5mb3JtYXRpb24uXHJcbiAgICAgKiBAYXBpTmFtZSBnZXRDb21tYW5kXHJcbiAgICAgKiBAYXBpZ3JvdXAgQ29tbWFuZFxyXG4gICAgICogQGFwaVBhcmFtIHtTdHJpbmd9IGNvbW1hbmRfaWQgSWQgb2YgY29tbWFuZC5cclxuICAgICAqIEBhcGlTdWNjZXNzIHtPYmplY3R9IGNvbW1hbmQgQ29tbWFuZCBpbmZvcm1hdGlvbiBmb3VuZC5cclxuICAgICAqIEBhcGlFcnJvciAoNTAyKSBFcnJvciBFcnJvciB0byByZXF1ZXN0IGRhdGFiYXNlLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgZ2V0Q29tbWFuZCAoe3JlcXVlc3QsIHJlc3BvbnNlfTpIdHRwQ29udGV4dENvbnRyYWN0KXtcclxuICAgICAgICB0cnkgeyAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgQ29tbWFuZC5maW5kT25lKHtfaWQ6cmVxdWVzdC5pbnB1dCgnY29tbWFuZF9pZCcpfSlcclxuICAgICAgICB9Y2F0Y2goZXJyKXtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1cyg1MDIpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGFwaSB7cG9zdH0gL2NyZWF0ZV9jb21tYW5kIENyZWF0ZSBhIG5ldyBDb21tYW5kLlxyXG4gICAgICogQGFwaU5hbWUgY3JlYXRlQ29tbWFuZFxyXG4gICAgICogQGFwaUdyb3VwIENvbW1hbmRcclxuICAgICAqIEBhcGlQYXJhbSAoQm9keSkge09iamVjdH0gY29tbWFuZCBDb21tYW5kIG9iamVjdC5cclxuICAgICAqIEBhcGlTdWNjZXNzIHJlc3BvbnNlIENvbW1hbmQgY3JlYXRlZC5cclxuICAgICAqIEBhcGlFcnJvciAoNTAyKSBFcnJvciBFcnJvciB0byByZXF1ZXN0IGRhdGFiYXNlLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgY3JlYXRlQ29tbWFuZCAoe3JlcXVlc3QsIHJlc3BvbnNlfTpIdHRwQ29udGV4dENvbnRyYWN0KXtcclxuICAgICAgICB0cnl7XHJcbiAgICAgICAgICAgIGF3YWl0IENvbW1hbmQuY3JlYXRlKHJlcXVlc3QuYm9keSgpKVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uub2soXCJDb21tYW5kIGNyZWF0ZWRcIilcclxuICAgICAgICB9Y2F0Y2goZXJyKXtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1cyg1MDIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBAYXBpIHtwdXR9IC9lZGl0X2NvbW1hbmQgRWRpdCBhIENvbW1hbmQuXHJcbiAgICAgKiBAYXBpTmFtZSBlZGl0Q29tbWFuZFxyXG4gICAgICogQGFwaUdyb3VwIENvbW1hbmRcclxuICAgICAqIEBhcGlQYXJhbSB7U3RyaW5nfSBjb21tYW5kX2lkIElkIG9mIGNvbW1hbmQuXHJcbiAgICAgKiBAYXBpUGFyYW0gKEJvZHkpIHtPYmplY3R9IGNvbW1hbmQgQ29tbWFuZCBvYmplY3QuXHJcbiAgICAgKiBAYXBpU3VjY2VzcyByZXNwb25zZSBDb21tYW5kIGVkaXRlZC5cclxuICAgICAqIEBhcGlFcnJvciAoNTAyKSBFcnJvciBFcnJvciB0byByZXF1ZXN0IGRhdGFiYXNlLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgZWRpdENvbW1hbmQgKHtyZXF1ZXN0LCByZXNwb25zZX06SHR0cENvbnRleHRDb250cmFjdCl7XHJcbiAgICAgICAgdHJ5e1xyXG4gICAgICAgICAgICBhd2FpdCBDb21tYW5kLnVwZGF0ZU9uZSh7X2lkOnJlcXVlc3QuaW5wdXQoJ2NvbW1hbmRfaWQnKX0sIHJlcXVlc3QuYm9keSgpKVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uub2soXCJDb21tYW5kIGVkaXRlZFwiKSAgIFxyXG4gICAgICAgIH1jYXRjaChlcnIpe1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzKDUwMilcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAYXBpIHtkZWxldGV9IC9kZWxldGVfY29tbWFuZCBEZWxldGUgYSBDb21tYW5kLlxyXG4gICAgICogQGFwaU5hbWUgZGVsZXRlQ29tbWFuZFxyXG4gICAgICogQGFwaUdyb3VwIENvbW1hbmRcclxuICAgICAqIEBhcGlQYXJhbSB7U3RyaW5nfSBjb21tYW5kX2lkIElkIG9mIGNvbW1hbmQuXHJcbiAgICAgKiBAYXBpU3VjY2VzcyByZXNwb25zZSBDb21tYW5kIGRlbGV0ZWQuXHJcbiAgICAgKiBAYXBpRXJyb3IgKDUwMikgRXJyb3IgRXJyb3IgdG8gcmVxdWVzdCBkYXRhYmFzZS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIGFzeW5jIGRlbGV0ZUNvbW1hbmQgKHtyZXF1ZXN0LCByZXNwb25zZX06SHR0cENvbnRleHRDb250cmFjdCl7XHJcbiAgICAgICAgdHJ5e1xyXG4gICAgICAgICAgICBhd2FpdCBDb21tYW5kLmRlbGV0ZU9uZSh7X2lkOnJlcXVlc3QuaW5wdXQoJ2NvbW1hbmRfaWQnKX0pXHJcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5vayhcIkNvbW1hbmQgZGVsZXRlZFwiKSAgXHJcbiAgICAgICAgfWNhdGNoKGVycil7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXMoNTAyKVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBhcGkge3BhdGNofSAvcGF5X2NvbW1hbmQgUGF5IGEgQ29tbWFuZC5cclxuICAgICAqIEBhcGlOYW1lIHBheUNvbW1hbmRcclxuICAgICAqIEBhcGlHcm91cCBDb21tYW5kXHJcbiAgICAgKiBAYXBpUGFyYW0ge1N0cmluZ30gY29tbWFuZF9pZCBJZCBvZiBjb21tYW5kLlxyXG4gICAgICogQGFwaVN1Y2Nlc3MgcmVzcG9uc2UgQ29tbWFuZCBwYWlkLlxyXG4gICAgICogQGFwaUVycm9yICg1MDIpIEVycm9yIEVycm9yIHRvIHJlcXVlc3QgZGF0YWJhc2UuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhc3luYyBwYXlDb21tYW5kICh7cmVxdWVzdCwgcmVzcG9uc2V9Okh0dHBDb250ZXh0Q29udHJhY3Qpe1xyXG4gICAgICAgIHRyeXtcclxuICAgICAgICAgICAgYXdhaXQgQ29tbWFuZC51cGRhdGVPbmUoe19pZDpyZXF1ZXN0LmlucHV0KCdjb21tYW5kX2lkJyl9LCB7cGFpZDp0cnVlfSkgXHJcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5vayhcIkNvbW1hbmQgcGFpZFwiKSAgICAgIFxyXG4gICAgICAgIH1jYXRjaChlcnIpe1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzKDUwMilcclxuICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAYXBpIHtwYXRjaH0gL3ZhbGlkYXRlX2NvbW1hbmQgVmFsaWRhdGUgYSBDb21tYW5kLlxyXG4gICAgICAgICAqIEBhcGlOYW1lIHZhbGlkYXRlQ29tbWFuZFxyXG4gICAgICAgICAqIEBhcGlHcm91cCBDb21tYW5kXHJcbiAgICAgICAgICogQGFwaVBhcmFtIHtTdHJpbmd9IGNvbW1hbmRfaWQgSWQgb2YgY29tbWFuZC5cclxuICAgICAgICAgKiBAYXBpU3VjY2VzcyByZXNwb25zZSBDb21tYW5kIHZhbGlkYXRlZC5cclxuICAgICAgICAgKiBAYXBpRXJyb3IgKDUwMikgRXJyb3IgRXJyb3IgdG8gcmVxdWVzdCBkYXRhYmFzZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICAgcHVibGljIGFzeW5jIHZhbGlkYXRlQ29tbWFuZCAoe3JlcXVlc3QsIHJlc3BvbnNlfTpIdHRwQ29udGV4dENvbnRyYWN0KXtcclxuICAgICAgICAgICAgdHJ5e1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgQ29tbWFuZC51cGRhdGVPbmUoe19pZDpyZXF1ZXN0LmlucHV0KCdjb21tYW5kX2lkJyl9LCB7dmFsaWRhdGVkOnRydWV9KSBcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5vayhcIkNvbW1hbmQgdmFsaWRhdGVkXCIpICAgICAgXHJcbiAgICAgICAgICAgIH1jYXRjaChlcnIpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1cyg1MDIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgLyogICAgSGlzdG9yaWMgcmVxdWVzdHMgICAgKi9cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBhcGkge2dldH0gL2dldF9oaXN0b3JpY19jb21tYW5kIEdldCBDb21tYW5kcyBvZiBhIHVzZXIuXHJcbiAgICAgKiBAYXBpTmFtZSBnZXRIaXN0b3JpY0NvbW1hbmRcclxuICAgICAqIEBhcGlHcm91cCBDb21tYW5kXHJcbiAgICAgKiBAYXBpUGFyYW0ge051bWJlcn0gY2xpZW50X2lkIElkIG9mIGNvbW1hbmQuXHJcbiAgICAgKiBAYXBpU3VjY2VzcyB7T2JqZWN0W119IGxpc3RfY29tbWFuZCBIaXN0b3JpYyBvZiBjb21tYW5kcy5cclxuICAgICAqIEBhcGlFcnJvciAoNTAyKSBFcnJvciBFcnJvciB0byByZXF1ZXN0IGRhdGFiYXNlLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgZ2V0SGlzdG9yaWNDb21tYW5kICh7cmVxdWVzdCwgcmVzcG9uc2V9KXtcclxuICAgICAgICB0cnl7XHJcbiAgICAgICAgICAgIGNvbnN0IHRva2VuID0gcmVxdWVzdC5oZWFkZXIoJ2F1dGhvcml6YXRpb24nKS5zcGxpdChcIiBcIilcclxuICAgICAgICAgICAgY29uc3QgdXNlcl9pZD1qd3QudmVyaWZ5KHRva2VuWzFdLCBcIlRPS0VOX1BSSVZBVEVfS0VZXCIpLnVzZXJfaWRcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnNlbmQoYXdhaXQgQ29tbWFuZC5maW5kKHsnaW5mby5jbGllbnQudXNlcl9pZCc6dXNlcl9pZH0pKVxyXG4gICAgICAgIH1jYXRjaChlcnIpe1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzKDUwMilcclxuICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBhcGkge2RlbGV0ZX0gL2RlbGV0ZV9oaXN0b3JpY19jb21tYW5kIERlbGV0ZSBDb21tYW5kcyBoaXN0b3JpYy5cclxuICAgICAqIEBhcGlOYW1lIGRlbGV0ZUhpc3RvcmljQ29tbWFuZFxyXG4gICAgICogQGFwaUdyb3VwIENvbW1hbmRcclxuICAgICAqIEBhcGlQYXJhbSAoQm9keSkge1N0cmluZ1tdfSBsaXN0X2NvbW1hbmRfaWQgTGlzdCBvZiBpZCBvZiBjb21tYW5kLlxyXG4gICAgICogQGFwaVN1Y2Nlc3MgcmVzcG9uc2UgSGlzdG9yaWMgZGVsZXRlZC5cclxuICAgICAqIEBhcGlFcnJvciAoNTAyKSBFcnJvciBFcnJvciB0byByZXF1ZXN0IGRhdGFiYXNlLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgZGVsZXRlSGlzdG9yaWNDb21tYW5kICh7cmVxdWVzdCwgcmVzcG9uc2V9Okh0dHBDb250ZXh0Q29udHJhY3Qpe1xyXG4gICAgICAgIHRyeXtcclxuICAgICAgICAgICAgYXdhaXQgQ29tbWFuZC5kZWxldGVNYW55KHtfaWQ6IHsgJGluOiByZXF1ZXN0LmJvZHkoKS5kZWxldGVfaGlzdG9yaWN9fSlcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLm9rKFwiQ29tbWFuZHMgZGVsZXRlZFwiKVxyXG4gICAgICAgIH1jYXRjaChlcnIpe1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzKDUwMilcclxuICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgfVxyXG59XHJcbiJdfQ==